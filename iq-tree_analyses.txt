## Maximum Likelihood Tree - Unpartitioned ##


######################################################
### Maximum Likelihood Tree - Partitioned by Locus ###
######################################################

## Get the partitioned tree ##
iqtree -s muscle-nexus-clean-70p_75p.phylip -spp partition-70p_75p.nexus -m MFP 
-bb 10000 -nt 19

# -s is concatenated alignment output from muscle
#  -spp partition file has character set outputs from Muscle and just tells iqtree where the separations of each locus are in the concatenated alignment
# -m specifies to use modelfinder to optimize the best substitution model for each locus
# -bb 10,000 ultrafast bootstraps
# -nt number of threads

## Calculate gcf and scf values for partitioned alignment ##
iqtree2 -t ML_partition.treefile --gcf gene_trees.newick -s muscle-nexus-clean-70p_75p.phylip --scf 100 -T 18

# note that this feature is only available in iqtree2, not iqtree
# -t is topology
# --gcf contains gene trees concatenated into a newick file, output from unpartitioned ML tree steps
# -s is concatenated alignment
# --scf contains suggested default value
# -T is numbe rof threads
